<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="/assets/css/markdown.css">
    <link rel="stylesheet" href="/assets/css/github-markdown-light.css">
</head>

<body>
    <article class="markdown-body">
<h1 id="%E5%BC%80%E5%8F%91%E5%89%8D%E9%A1%BB%E7%9F%A5" tabindex="-1">开发前须知</h1>
<div class="markdown-alert markdown-alert-note"><p class="markdown-alert-title"><svg class="octicon octicon-info mr-2" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>Note</p><p></p>
<p>只有当您想要开发 M9A 时才需要看当前页面！</p>
<p>用户请转到 <a href="../manual/%E6%96%B0%E6%89%8B%E4%B8%8A%E8%B7%AF.html">M9A 使用手册</a>。</p>
<p>开发 MaaFramework 或开发自己的项目请到 <a href="https://github.com/MaaXYZ/MaaFramework" target="_top" rel="noopener noreferrer">MaaXYZ/MaaFramework</a>。</p>
</div>
<h2 id="github-pull-request-%E6%B5%81%E7%A8%8B%E7%AE%80%E8%BF%B0" tabindex="-1">Github Pull Request 流程简述</h2>
<h3 id="%E6%88%91%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%EF%BC%8C%E5%8F%AA%E6%98%AF%E6%83%B3%E6%94%B9%E4%B8%80%E7%82%B9%E7%82%B9-json-%E6%96%87%E4%BB%B6%2F%E6%96%87%E6%A1%A3%E7%AD%89%EF%BC%8C%E8%A6%81%E6%80%8E%E4%B9%88%E6%93%8D%E4%BD%9C%EF%BC%9F" tabindex="-1">我不懂编程，只是想改一点点 JSON 文件/文档等，要怎么操作？</h3>
<p>欢迎收看 <a href="https://maa.plus/docs/zh-cn/develop/pr-tutorial.html" target="_top" rel="noopener noreferrer">牛牛也能看懂的 GitHub Pull Request 使用指南</a></p>
<h3 id="%E6%88%91%E6%9C%89%E7%BC%96%E7%A8%8B%E7%BB%8F%E9%AA%8C%EF%BC%8C%E4%BD%86%E6%98%AF%E6%B2%A1%E5%8F%82%E4%B8%8E%E8%BF%87%E7%9B%B8%E5%85%B3%E9%A1%B9%E7%9B%AE%EF%BC%8C%E8%A6%81%E6%80%8E%E4%B9%88%E5%81%9A%EF%BC%9F" tabindex="-1">我有编程经验，但是没参与过相关项目，要怎么做？</h3>
<ol>
<li>
<p>如果很久以前 fork 过，先在自己仓库的 <code>Settings</code> 里，翻到最下面，删除</p>
</li>
<li>
<p>打开 <a href="https://github.com/MAA1999/M9A" target="_top" rel="noopener noreferrer">M9A 主仓库</a>，点击 <code>Fork</code>，继续点击 <code>Create fork</code></p>
</li>
<li>
<p>克隆你自己的仓库到本地，并拉取子模块</p>
<pre><code class="language-bash">git <span class="hljs-built_in">clone</span> --recursive https://github.com/&lt;你的用户名&gt;/M9A.git
</code></pre>
<blockquote>
<p>⚠</p>
<p><strong>–recursive 一定不要忘！<strong><strong>–recursive 一定不要忘！</strong></strong>–recursive 一定不要忘！</strong></p>
<p>OCR异常失败很可能就是没加recursive导致。</p>
</blockquote>
</li>
<li>
<p>下载 MaaFramework 的 <a href="https://github.com/MaaXYZ/MaaFramework/releases" target="_top" rel="noopener noreferrer">Release 包</a>，解压到 <code>deps</code> 文件夹中。</p>
</li>
<li>
<p>配置编程环境</p>
<ul>
<li>
<p>下载并安装vscode</p>
</li>
<li>
<p>选择性安装调试/开发工具</p>
<table>
<thead>
<tr>
<th>工具</th>
<th>简介</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/MaaXYZ/MaaDebugger" target="_top" rel="noopener noreferrer">MaaDebugger</a></td>
<td>独立调试工具</td>
</tr>
<tr>
<td><a href="https://marketplace.visualstudio.com/items?itemName=nekosu.maa-support" target="_top" rel="noopener noreferrer">Maa Pipeline Support</a></td>
<td>VSCode 插件，提供调试、截图、获取 ROI 、取色等功能</td>
</tr>
<tr>
<td><a href="https://github.com/SweetSmellFox/MFATools" target="_top" rel="noopener noreferrer">MFA Tools</a></td>
<td>独立截图、获取 ROI 及取色工具</td>
</tr>
<tr>
<td><a href="https://github.com/MaaXYZ/MaaFramework/tree/main/tools/ImageCropper" target="_top" rel="noopener noreferrer">ImageCropper(不推荐)</a></td>
<td>独立截图及获取 ROI 工具</td>
</tr>
</tbody>
</table>
</li>
</ul>
</li>
<li>
<p>本地安装</p>
<ol>
<li>
<p>安装嵌入式python（仅Windows需要）</p>
<pre><code class="language-bash">./tools/ci/setup_embed_python.ps1
</code></pre>
</li>
<li>
<p>通过运行 install 组装部件</p>
<pre><code class="language-bash">python ./tools/install.py
</code></pre>
</li>
</ol>
<p>便可以在 install 文件夹运行 M9A 了。</p>
</li>
<li>
<p>开始开发</p>
<p>开始愉快的改代码吧，开始前查看<a href="#%E7%9B%B8%E5%85%B3%E9%98%85%E8%AF%BB">相关阅读</a>。</p>
</li>
<li>
<p>git 操作</p>
<p>通常用的最多的基本命令有：</p>
<ul>
<li><code>git add &lt;file&gt;</code>：添加文件到暂存区，<code>*</code> 代表全部文件</li>
<li><code>git commit -m &quot;message&quot;</code>：提交暂存区到本地仓库。<code>message</code> 请遵循 <a href="https://www.conventionalcommits.org/zh-hans/v1.0.0/" target="_top" rel="noopener noreferrer">约定式提交规范</a>，让你的 commit 信息更加清晰</li>
<li><code>git pull origin &lt;branch&gt;</code>：拉取远程仓库到本地仓库</li>
<li><code>git push origin &lt;branch&gt;</code>：推送本地仓库到远程仓库</li>
</ul>
<blockquote>
<p>⚠</p>
<p>开发过程中，每一定数量，记得提交一个 commit, 别忘了写上 message
假如你不熟悉 git 的使用，你可能需要创建并切换到一个新的分支，而不是直接提交在 main 上
这样你的提交就能在新的分支上生长，不会受到 main 更新的打扰</p>
</blockquote>
<pre><code class="language-bash">git checkout -b &lt;branch-name&gt; <span class="hljs-comment"># 创建并切换到新的分支</span>
</code></pre>
<p>完成开发后，推送你修改的本地分支到远程仓库（fork 的仓库）</p>
<pre><code class="language-bash">git push origin &lt;branch-name&gt;
</code></pre>
<p>当 M9A 仓库出现更改（如其他人的commit），你可能需要把这些更改同步到你的分支</p>
<ol>
<li>
<p>关联 M9A 原仓库：</p>
<pre><code class="language-bash">git remote add upstream https://github.com/MAA1999/M9A.git`
</code></pre>
</li>
<li>
<p>拉取远程仓库更新：</p>
<pre><code class="language-bash">git fetch upstream
</code></pre>
</li>
<li>
<p>变基（推荐）或者合并修改：</p>
<pre><code class="language-bash">git rebase upstream/main <span class="hljs-comment"># 变基，使commit历史更清晰，完成你的个人pr时建议使用rebase而不是merge来合并修改</span>
</code></pre>
<p>或者</p>
<pre><code class="language-bash">git merge upstream/main
</code></pre>
</li>
</ol>
<p>git 参考资料：</p>
<ul>
<li><a href="https://git-scm.com/docs" target="_top" rel="noopener noreferrer">git 官方文档</a></li>
<li><a href="https://www.runoob.com/manual/git-guide/" target="_top" rel="noopener noreferrer">git 简明指南</a></li>
<li><a href="https://www.runoob.com/git/git-tutorial.html" target="_top" rel="noopener noreferrer">git 教程|菜鸟教程</a></li>
</ul>
</li>
<li>
<p>提交 Pull Request</p>
<p>你修改的代码已经提交到你的仓库，现在你需要提交一个 Pull Request 到 M9A 的仓库，等待维护者审核</p>
<p><a href="https://maa.plus/docs/zh-cn/develop/pr-tutorial.html" target="_top" rel="noopener noreferrer">GitHub Pull Request 参考</a></p>
</li>
</ol>
<h2 id="m9a-%E6%A0%BC%E5%BC%8F%E5%8C%96%E8%A6%81%E6%B1%82" tabindex="-1">M9A 格式化要求</h2>
<p>M9A 使用一系列的格式化工具来保证仓库中的代码和资源文件美观统一，以便于维护和阅读</p>
<p>请确保在提交之前已经格式化，或是<a href="#pre-commit-hooks">启用 Pre-commit Hooks 进行自动格式化</a></p>
<p>目前启用的格式化工具如下：</p>
<table>
<thead>
<tr>
<th>文件类型</th>
<th>格式化工具</th>
</tr>
</thead>
<tbody>
<tr>
<td>JSON/Yaml</td>
<td><a href="https://prettier.io/" target="_top" rel="noopener noreferrer">prettier</a></td>
</tr>
<tr>
<td>Markdown</td>
<td><a href="https://github.com/DavidAnson/markdownlint-cli2" target="_top" rel="noopener noreferrer">MarkdownLint</a></td>
</tr>
</tbody>
</table>
<h3 id="%E5%88%A9%E7%94%A8-pre-commit-hooks-%E8%87%AA%E5%8A%A8%E8%BF%9B%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%A0%BC%E5%BC%8F%E5%8C%96" tabindex="-1">利用 Pre-commit Hooks 自动进行代码格式化</h3>
<p><a id="pre-commit-hooks"></a></p>
<ol>
<li>
<p>确保你的电脑上有 Python 与 Node 环境</p>
</li>
<li>
<p>在项目根目录下执行以下命令</p>
<pre><code class="language-bash">pip install pre-commit
pre-commit install
</code></pre>
</li>
</ol>
<p>如果pip安装后依然无法运行pre-commit，请确认pip安装地址已被添加到PATH</p>
<p>接下来，每次提交时都将会自动运行格式化工具，来确保你的代码格式符合规范</p>
<p>手动触发：</p>
<pre><code class="language-bash">pre-commit run --all-files
</code></pre>
<h2 id="%E7%9B%B8%E5%85%B3%E9%98%85%E8%AF%BB" tabindex="-1">相关阅读</h2>
<ul>
<li><a href="./%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84.html">项目结构</a></li>
<li><a href="./interface.json%E7%BC%96%E5%86%99.html">interface.json编写</a></li>
<li><a href="./Pipeline%E7%BC%96%E5%86%99.html">Pipeline编写</a></li>
<li><a href="./Custom%E7%BC%96%E5%86%99.html">Custom编写</a></li>
<li><a href="./%E9%A1%B9%E7%9B%AE%E9%87%8D%E6%9E%84.html">项目重构</a></li>
<li><a href="./%E5%A4%96%E6%9C%8D%E9%80%82%E9%85%8D.html">外服适配</a></li>
<li><a href="./%E6%96%87%E6%A1%A3%E7%BC%96%E5%86%99.html">文档编写</a></li>
</ul>

    </article>
</body>

</html>