<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/assets/css/markdown.css">
    <link rel="stylesheet" href="/assets/css/github-markdown-light.css">
</head>

<body>
    <article class="markdown-body">
<h1 id="bug-troubleshooting" tabindex="-1">Bug Troubleshooting</h1>
<p>Fixing bugs is also an important part of development.<br>
There are techniques to quickly and accurately locate, analyze, and resolve bugs.<br>
This article will briefly introduce the general process of troubleshooting bugs.</p>
<div class="markdown-alert markdown-alert-note"><p class="markdown-alert-title"><svg class="octicon octicon-info mr-2" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>Note</p><p></p>
<p>The following content is for reference only. Please pay attention to its timeliness.</p>
</div>
<h2 id="preparations" tabindex="-1">Preparations</h2>
<p>Communicate with the person who reported the bug to gather as much relevant information as possible, such as:</p>
<ul>
<li>Detailed description of the issue (time of occurrence, scenario, etc.)</li>
<li>Necessary information like configuration files, logs, screenshots, etc.</li>
</ul>
<h2 id="locating-key-logs" tabindex="-1">Locating Key Logs</h2>
<ol>
<li>
<p>Confirm the resource version and runtime mode</p>
<p>For M9A, there are two runtime modes: 1. MaaPiCli 2. MFA</p>
<p>Based on observations, the log for MaaPiCli runtime contains the line:</p>
<pre><code class="language-plaintext">[2024-11-28 19:46:32.571][INF][Px14600][Tx16498][Parser.cpp][L56][MaaNS::ProjectInterfaceNS::Parser::parse_interface] Interface Version: [data.version=v2.4.11]
</code></pre>
<p>While the log for MFAWPF runtime contains the line:</p>
<pre><code class="language-plaintext">MFAWPF Version: [mfa.version=v1.2.2.0] Interface Version: [data.version=v2.5.5] 
</code></pre>
<p>The <code>data.version</code> can be used to determine the resource version. This helps to check whether the bug in the current version has already been fixed.<br>
Also, confirm the runtime mode, as different modes may affect the reproduction of the issue.</p>
</li>
<li>
<p>Locate the log position related to the issue</p>
<p>There are two scenarios:</p>
<ul>
<li>Task ends prematurely</li>
<li>Task gets stuck in an infinite loop</li>
</ul>
<p>For the former, globally search for <strong>[ERR]</strong> to check what the error is related to.<br>
For the latter, globally search for <strong>Node Hit</strong> to find abnormal matching situations (e.g., continuously matching a node that shouldnâ€™t be matched repeatedly).</p>
</li>
</ol>
<h2 id="analyzing-the-issue" tabindex="-1">Analyzing the Issue</h2>
<p>Here, issues are roughly categorized into three types: resource loading issues, connection issues, and pipeline issues.</p>
<h3 id="resource-loading-issues" tabindex="-1">Resource Loading Issues</h3>
<p>Resource loading failure caused by overwriting installation when renaming resources:</p>
<pre><code class="language-log">[2024-11-17 22:29:04.185][ERR][Px10564][Tx9380][PipelineResMgr.cpp][L211][MaaNS::ResourceNS::PipelineResMgr::parse_config] key already exists [key=OutsideDeduction] 
</code></pre>
<h3 id="connection-issues" tabindex="-1">Connection Issues</h3>
<p>Simulator connection failure:</p>
<pre><code class="language-log">[2024-11-24 23:44:05.539][ERR][Px26056][Tx55883][ControlUnitMgr.cpp][L55][MaaNS::CtrlUnitNs::ControlUnitMgr::connect] failed to connect [adb_path_=D:/MuMu Player 12/shell/adb.exe] [adb_serial_=127.0.0.1:16384]
</code></pre>
<h3 id="pipeline-issues" tabindex="-1">Pipeline Issues</h3>
<p>These are the main issues M9A needs to focus on. Understanding the original pipeline process and analyzing the execution shown in the logs is necessary.</p>
<ol>
<li>
<p>Non-pipeline process-related issues</p>
<p>These issues are not caused by logical problems in the pipeline process itself.</p>
<p>Based on the problematic node, there are two types:</p>
<p>The first type is non-unconditional matching/inverse nodes.<br>
A common cause is that screenshots are taken too quickly, matching the <code>next</code> node, but the current screen has not stabilized yet.<br>
The solution is to add appropriate <code>post_wait_freezes</code> to the current node to wait for the screen to stabilize before making a judgment.</p>
<p>The second type is unconditional matching/inverse nodes.<br>
This may occur when entering an unexpected interface, leading to incorrect judgments.<br>
The solution is to modify as needed.</p>
</li>
<li>
<p>Pipeline process-related issues</p>
<p>These issues are due to the incompleteness of the task process itself and require modifications after analysis.</p>
</li>
</ol>
<h2 id="resolving-the-issue" tabindex="-1">Resolving the Issue</h2>
<p>Refer to <a href="../manual/faq.html">Common Issues</a> for the first two types of issues. For pipeline issues, modify based on the analysis results.</p>
<h2 id="verifying-the-fix" tabindex="-1">Verifying the Fix</h2>
<p>After fixing, release a test version. If the test is successful, the issue is resolved.</p>

    </article>
</body>

</html>